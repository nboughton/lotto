$(function(){function e(){return{start:$(i.dateStart).val(),end:$(i.dateEnd).val(),set:$(i.setSelect).val(),machine:$(i.machineSelect).val()}}function t(){$.getJSON("/api/sets",e(),function(e){var t=$(i.setSelect);t.empty().append('<option value="0">All</option>'),$.each(e,function(e,a){t.append('<option value="'+a+'">'+a+"</option>")})})}function a(){$.getJSON("/api/machines",e(),function(e){var t=$(i.machineSelect);t.empty().append('<option value="all">All</option>'),$.each(e,function(e,a){t.append('<option value="'+a+'">'+a+"</option>")})})}function s(t){$.getJSON("/api/results/average"+t,e(),function(e){$(i.results).empty().append('<h1 id="'+i.resultsAvg.replace("#","")+'" class="centered"></h1>'),$.each(e,function(e,t){$(i.resultsAvg).append("<span class='num'>"+t+"</span>")})})}function r(t,a){$.getJSON("/api/results/graph/"+t,e(),function(e){$(i.results).empty().append('<div id="'+i.resultsGraph.replace("#","")+'"></div>'),Plotly.newPlot(i.resultsGraph.replace("#",""),e,a)})}var i={machineSelect:"#filter-machine",setSelect:"#filter-set",dateClass:".form-date",dateStart:"#date-start",dateEnd:"#date-end",queryType:"#query-type",querySubmit:"#query-submit",results:"#results",resultsAvg:"#results-average",resultsGraph:"#results-graph"},n={freqdist:{bar:{barmode:"stack",xaxis:{title:"Result"},yaxis:{title:"Frequency"}},scatter:{xaxis:{title:"Result"},yaxis:{title:"Frequency"}}},timeseries:{line:{xaxis:{title:"Date:Set:Machine"},yaxis:{title:"Result"}}},scatter3D:{scene:{xaxis:{title:"Machine"},yaxis:{title:"Set"},zaxis:{title:"Result"}}}};$.getJSON("/api/range",function(e){var t={format:"yyyy-mm-dd",selectYears:!0,selectMonths:!0,min:new Date(1e3*e.first),max:new Date(1e3*e.last)};$(i.dateClass).pickadate(t)}),$(i.machineSelect).change(function(e){t()}),$(i.dateClass).change(function(e){a(),t()}),$(i.querySubmit).click(function(e){switch($(i.queryType).val()){case"num-average-mean":s("");break;case"num-average-ranges":s("/ranges");break;case"graph-freqdist-bar":r("freqdist/bar",n.freqdist.bar);break;case"graph-freqdist-scatter":r("freqdist/scatter",n.freqdist.scatter);break;case"graph-freqdist-ms":r("freqdist-ms");break;case"graph-timeseries-scatter":r("timeseries/scatter",n.timeseries.line);break;case"graph-timeseries-line":r("timeseries/line",n.timeseries.line);break;case"graph-3d-scatter":r("3d/scatter",n.scatter3D)}}),r("freqdist/bar",n.freqdist.bar)});