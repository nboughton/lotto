$(function(){function e(){return{start:$(i.dateStart).val(),end:$(i.dateEnd).val(),set:$(i.setSelect).val(),machine:$(i.machineSelect).val()}}function t(){$.getJSON("/api/sets",e(),function(e){var t=$(i.setSelect);t.empty().append('<option value="0">All</option>'),$.each(e,function(e,s){t.append('<option value="'+s+'">'+s+"</option>")})})}function s(){$.getJSON("/api/machines",e(),function(e){var t=$(i.machineSelect);t.empty().append('<option value="all">All</option>'),$.each(e,function(e,s){t.append('<option value="'+s+'">'+s+"</option>")})})}function a(t){$.getJSON("/api/numbers",e(),function(e){var s=$(i.results);s.empty();var a=i.resultsNum.replace("#","freq");s.append("<h3>Most Frequent Numbers</h3>"),s.append('<h4 id="'+a+'" class="centered"></h4>'),n(e.frequent,a),a=i.resultsNum.replace("#","least"),s.append("<h3>Least Frequent Numbers</h3>"),s.append('<h4 id="'+a+'" class="centered"></h4>'),n(e.least,a),a=i.resultsNum.replace("#","avg"),s.append("<h3>Mean Average Results</h3>"),s.append('<h4 id="'+a+'" class="centered"></h4>'),n(e.meanAvg,a),a=i.resultsNum.replace("#","random"),s.append("<h3>Random Set</h3>"),s.append('<h4 id="'+a+'" class="centered"></h4>'),n(e.random,a),a=i.resultsNum.replace("#","ranges"),s.append("<h3>Result Ranges</h3>"),s.append('<h4 id="'+a+'" class="centered"></h4>'),n(e.ranges,a),t&&s.append("<p>"+t+"</p>")})}function r(t,s){$.getJSON("/api/graph/"+t,e(),function(e){$(i.results).empty().append('<div id="'+i.resultsGraph.replace("#","")+'"></div>'),Plotly.newPlot(i.resultsGraph.replace("#",""),e,s)})}function n(e,t){$.each(e,function(e,s){$("#"+t).append("<span class='num'>"+s+"</span>")})}var i={machineSelect:"#filter-machine",setSelect:"#filter-set",dateClass:".form-date",dateStart:"#date-start",dateEnd:"#date-end",queryType:"#query-type",querySubmit:"#query-submit",results:"#results",resultsNum:"#results-numbers",resultsGraph:"#results-graph"},l={freqdist:{bar:{barmode:"stack",xaxis:{title:"Result"},yaxis:{title:"Frequency"}},scatter:{xaxis:{title:"Result"},yaxis:{title:"Frequency"}},ms:{xaxis:{title:"Machine"},yaxis:{title:"Set"},hovermode:"closest"}},timeseries:{line:{xaxis:{title:"Date:Set:Machine"},yaxis:{title:"Result"}}},scatter3D:{results:{scene:{xaxis:{title:"Machine"},yaxis:{title:"Set"},zaxis:{title:"Result"}}},frequency:{scene:{xaxis:{title:"Machine"},yaxis:{title:"Set"},zaxis:{title:"Frequency"}}}}};$.getJSON("/api/range",function(e){var t={format:"yyyy-mm-dd",selectYears:!0,selectMonths:!0,min:new Date(1e3*e.first),max:new Date(1e3*e.last)};$(i.dateClass).pickadate(t)}),$(i.machineSelect).change(function(e){t()}),$(i.dateClass).change(function(e){s(),t()}),$(i.querySubmit).click(function(e){switch($(i.queryType).val()){case"num-results":a();break;case"graph-results-freqdist-bar":r("results/freqdist/bar",l.freqdist.bar);break;case"graph-results-freqdist-scatter":r("results/freqdist/scatter",l.freqdist.scatter);break;case"graph-results-timeseries-scatter":r("results/timeseries/scatter",l.timeseries.line);break;case"graph-results-timeseries-line":r("results/timeseries/line",l.timeseries.line);break;case"graph-results-raw-scatter3d":r("results/raw/scatter3d",l.scatter3D.results);break;case"graph-ms-freqdist-bubble":r("ms/freqdist/bubble",l.freqdist.ms);break;case"graph-ms-freqdist-scatter3d":r("ms/freqdist/scatter3d",l.scatter3D.frequency)}}),a("The 'bonus', or last ball in each of these sets is treated as a separate entity from the first 6, however some calculation is done to ensure that no duplicate numbers turn up in any of the sets.")});