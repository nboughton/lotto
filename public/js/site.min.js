$(function(){function e(){return{start:$(l.dateStart).val(),end:$(l.dateEnd).val(),set:$(l.setSelect).val(),machine:$(l.machineSelect).val()}}function t(){$.getJSON("/api/sets",e(),function(e){var t=$(l.setSelect);t.empty().append('<option value="0">All</option>'),$.each(e,function(e,a){t.append('<option value="'+a+'">'+a+"</option>")})})}function a(){$.getJSON("/api/machines",e(),function(e){$(l.machineSelect).empty().append('<option value="all">All</option>'),$.each(e,function(e,t){$(l.machineSelect).append('<option value="'+t+'">'+t+"</option>")})})}function n(){$.getJSON("/api/results/average",e(),function(e){for($(l.results).empty().append('<h1 id="'+l.resultsAvg.replace("#","")+'" class="centered"></h1>'),i=0;i<e.length;i++)$(l.resultsAvg).append("<span class='num'>"+e[i]+"</span>")})}function s(t){$.getJSON("/api/results/graph/"+t,e(),function(e){$(l.results).empty().append('<div id="'+l.resultsGraph.replace("#","")+'"></div>'),Plotly.newPlot(l.resultsGraph.replace("#",""),e)})}var l={machineSelect:"#filter-machine",setSelect:"#filter-set",dateClass:".form-date",dateStart:"#date-start",dateEnd:"#date-end",queryType:"#query-type",querySubmit:"#query-submit",results:"#results",resultsAvg:"#results-average",resultsGraph:"#results-graph"};$.getJSON("/api/range",function(e){var t={format:"yyyy-mm-dd",selectYears:!0,selectMonths:!0,min:new Date(1e3*e.first),max:new Date(1e3*e.last)};$(l.dateClass).pickadate(t)}),$(l.machineSelect).change(function(e){t()}),$(l.dateClass).change(function(e){a(),t()}),$(l.querySubmit).click(function(e){switch($(l.queryType).val()){case"num-average":n();break;case"graph-line":s("line");break;case"graph-3d-scatter":s("3d/scatter")}})});